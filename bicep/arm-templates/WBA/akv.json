{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
      "vaults_tiger_team02_aml_akv10_name": {
          "defaultValue": "tiger-team02-aml-akv10",
          "type": "string"
      },
      "virtualnetworks_gs_nprod_cloudplatforms_sen_eastus2_vnet01_externalid": {
          "defaultValue": "/subscriptions/96a4f83f-9a81-4321-b8a6-1e198ca1fb31/resourceGroups/gs-nprod-cloudplatforms-sen-eastus2-vnet01-rg/providers/microsoft.network/virtualnetworks/gs-nprod-cloudplatforms-sen-eastus2-vnet01",
          "type": "string"
      }
  },
  "variables": {},
  "resources": [
      {
          "type": "Microsoft.KeyVault/vaults",
          "apiVersion": "2021-04-01-preview",
          "name": "[parameters('vaults_tiger_team02_aml_akv10_name')]",
          "location": "East US 2",
          "tags": {
              "DeptName": "Infrastructure",
              "LOB": "Infrastructure",
              "Deployer": "Rajasekhar.Padala@boots.co.uk",
              "DeployDate": "2020-02-19",
              "Sensitivity": "Non-Sensitive",
              "SenType": "Not Applicable",
              "EnvType": "Non-Production",
              "LegalSubEntity": "Walgreen Co",
              "SubDivision": "Global Cloud & Platform Service",
              "Department": "Cloud COE",
              "CostCenter": "Project LEAP 5001"
          },
          "properties": {
              "sku": {
                  "family": "A",
                  "name": "premium"
              },
              "tenantId": "92cb778e-8ba7-4f34-a011-4ba6e7366996",
              "networkAcls": {
                  "bypass": "AzureServices",
                  "defaultAction": "Deny",
                  "ipRules": [
                      {
                          "value": "204.15.117.96/30"
                      },
                      {
                          "value": "204.15.117.100/30"
                      },
                      {
                          "value": "204.15.117.104/29"
                      },
                      {
                          "value": "63.73.199.0/24"
                      },
                      {
                          "value": "63.239.17.0/24"
                      },
                      {
                          "value": "204.15.116.0/22"
                      },
                      {
                          "value": "63.239.17.0/24"
                      },
                      {
                          "value": "86.20.58.234/32"
                      },
                      {
                          "value": "163.170.130.55/32"
                      },
                      {
                          "value": "163.170.130.63/32"
                      },
                      {
                          "value": "40.69.44.35/32"
                      }
                  ],
                  "virtualNetworkRules": [
                      {
                          "id": "[concat(parameters('virtualnetworks_gs_nprod_cloudplatforms_sen_eastus2_vnet01_externalid'), '/subnets/aks02')]"
                      },
                      {
                          "id": "[concat(parameters('virtualnetworks_gs_nprod_cloudplatforms_sen_eastus2_vnet01_externalid'), '/subnets/aks01')]"
                      },
                      {
                          "id": "[concat(parameters('virtualnetworks_gs_nprod_cloudplatforms_sen_eastus2_vnet01_externalid'), '/subnets/app')]"
                      },
                      {
                          "id": "[concat(parameters('virtualnetworks_gs_nprod_cloudplatforms_sen_eastus2_vnet01_externalid'), '/subnets/web')]",
                          "ignoreMissingVnetServiceEndpoint": false
                      }
                  ]
              },
              "accessPolicies": [
                  {
                      "tenantId": "92cb778e-8ba7-4f34-a011-4ba6e7366996",
                      "objectId": "18f1d234-a01e-4e4d-a9d3-965e6edb468d",
                      "permissions": {
                          "keys": [
                              "get",
                              "list",
                              "update",
                              "create",
                              "import",
                              "delete",
                              "recover",
                              "backup",
                              "restore"
                          ],
                          "secrets": [
                              "get",
                              "list",
                              "set",
                              "delete",
                              "recover",
                              "backup",
                              "restore"
                          ],
                          "certificates": [
                              "get",
                              "list",
                              "update",
                              "create",
                              "import",
                              "delete",
                              "recover",
                              "backup",
                              "restore",
                              "managecontacts",
                              "manageissuers",
                              "getissuers",
                              "listissuers",
                              "setissuers",
                              "deleteissuers"
                          ]
                      }
                  },
                  {
                      "tenantId": "92cb778e-8ba7-4f34-a011-4ba6e7366996",
                      "objectId": "facd7794-8298-44e1-a08b-0953a1ecb660",
                      "permissions": {
                          "keys": [
                              "get",
                              "list",
                              "update",
                              "create"
                          ],
                          "secrets": [
                              "get",
                              "list",
                              "set",
                              "recover",
                              "backup",
                              "restore"
                          ],
                          "certificates": [
                              "get",
                              "list",
                              "update",
                              "create"
                          ]
                      }
                  },
                  {
                      "tenantId": "92cb778e-8ba7-4f34-a011-4ba6e7366996",
                      "objectId": "9e5cf44d-3fff-4d34-adaa-50ea19018ee7",
                      "permissions": {
                          "keys": [
                              "get",
                              "list",
                              "update",
                              "create"
                          ],
                          "secrets": [
                              "get",
                              "list",
                              "set",
                              "delete"
                          ],
                          "certificates": [
                              "get",
                              "list",
                              "update",
                              "create"
                          ]
                      }
                  },
                  {
                      "tenantId": "92cb778e-8ba7-4f34-a011-4ba6e7366996",
                      "objectId": "ee07e088-f953-4383-97f1-89fe2ff9bad2",
                      "permissions": {
                          "secrets": [
                              "get",
                              "list",
                              "set"
                          ],
                          "keys": [
                              "get",
                              "list",
                              "update",
                              "create"
                          ],
                          "certificates": [
                              "get",
                              "list",
                              "update",
                              "create"
                          ]
                      }
                  },
                  {
                      "tenantId": "92cb778e-8ba7-4f34-a011-4ba6e7366996",
                      "objectId": "deafede7-f162-4264-a88e-a5d7deeab1a3",
                      "permissions": {
                          "keys": [
                              "get",
                              "list",
                              "update",
                              "create",
                              "import",
                              "delete",
                              "recover",
                              "backup",
                              "restore",
                              "Decrypt",
                              "Encrypt",
                              "UnwrapKey",
                              "WrapKey",
                              "Verify",
                              "Sign",
                              "all"
                          ],
                          "secrets": [
                              "get",
                              "list",
                              "set",
                              "delete",
                              "recover",
                              "backup",
                              "restore",
                              "all"
                          ],
                          "certificates": [
                              "get",
                              "list",
                              "update",
                              "create",
                              "import",
                              "delete",
                              "recover",
                              "backup",
                              "restore",
                              "managecontacts",
                              "manageissuers",
                              "getissuers",
                              "listissuers",
                              "setissuers",
                              "deleteissuers",
                              "all"
                          ],
                          "storage": []
                      }
                  },
                  {
                      "tenantId": "92cb778e-8ba7-4f34-a011-4ba6e7366996",
                      "objectId": "41600b76-0fa5-410b-9a14-a6fe54713ea5",
                      "permissions": {
                          "keys": [
                              "all"
                          ],
                          "secrets": [
                              "all"
                          ],
                          "certificates": [
                              "all"
                          ]
                      }
                  },
                  {
                      "tenantId": "92cb778e-8ba7-4f34-a011-4ba6e7366996",
                      "objectId": "2e5adc47-2124-44f2-aeb9-71340d617dc5",
                      "permissions": {
                          "keys": [
                              "all"
                          ],
                          "secrets": [
                              "all"
                          ],
                          "certificates": [
                              "all"
                          ]
                      }
                  }
              ],
              "enabledForDeployment": true,
              "enabledForDiskEncryption": false,
              "enabledForTemplateDeployment": true,
              "enableSoftDelete": true,
              "enableRbacAuthorization": false,
              "enablePurgeProtection": true,
              "vaultUri": "[concat('https://', parameters('vaults_tiger_team02_aml_akv10_name'), '.vault.azure.net/')]",
              "provisioningState": "Succeeded"
          }
      },
      {
          "type": "Microsoft.KeyVault/vaults/keys",
          "apiVersion": "2019-09-01",
          "name": "[concat(parameters('vaults_tiger_team02_aml_akv10_name'), '/amlws10')]",
          "location": "East US 2",
          "dependsOn": [
              "[resourceId('Microsoft.KeyVault/vaults', parameters('vaults_tiger_team02_aml_akv10_name'))]"
          ],
          "properties": {
              "attributes": {
                  "enabled": true
              }
          }
      },
      {
          "type": "Microsoft.KeyVault/vaults/secrets",
          "apiVersion": "2021-04-01-preview",
          "name": "[concat(parameters('vaults_tiger_team02_aml_akv10_name'), '/074ee012-4150-4818-9efd-09499c6eefb6-IfOffk4YBCooCAPVL-1maOe-51zGDJ4HlVcd3Nf1W9s')]",
          "location": "East US 2",
          "dependsOn": [
              "[resourceId('Microsoft.KeyVault/vaults', parameters('vaults_tiger_team02_aml_akv10_name'))]"
          ],
          "properties": {
              "attributes": {
                  "enabled": true
              }
          }
      },
      {
          "type": "Microsoft.KeyVault/vaults/secrets",
          "apiVersion": "2021-04-01-preview",
          "name": "[concat(parameters('vaults_tiger_team02_aml_akv10_name'), '/20bda43f-429c-4dde-9113-396d2cba7837-IfOffk4YBCooCAPVL-1maOe-51zGDJ4HlVcd3Nf1W9s')]",
          "location": "East US 2",
          "dependsOn": [
              "[resourceId('Microsoft.KeyVault/vaults', parameters('vaults_tiger_team02_aml_akv10_name'))]"
          ],
          "properties": {
              "attributes": {
                  "enabled": true
              }
          }
      },
      {
          "type": "Microsoft.KeyVault/vaults/secrets",
          "apiVersion": "2021-04-01-preview",
          "name": "[concat(parameters('vaults_tiger_team02_aml_akv10_name'), '/703ec509-e916-4f4c-8f73-d9092859f963-IfOffk4YBCooCAPVL-1maOe-51zGDJ4HlVcd3Nf1W9s')]",
          "location": "East US 2",
          "dependsOn": [
              "[resourceId('Microsoft.KeyVault/vaults', parameters('vaults_tiger_team02_aml_akv10_name'))]"
          ],
          "properties": {
              "attributes": {
                  "enabled": true
              }
          }
      }
  ]
}